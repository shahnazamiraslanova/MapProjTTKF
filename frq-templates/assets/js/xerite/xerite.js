
//colors array is fake data array,just fetch your api here and assign data to colors,also change properties' name based on data
const colors = {
    2: {
        id: 2,
        bcgColor: "#90C474",
        title: "Lənkəran-Astara",
        male: 2200,
        female: 2200,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Lənkəran",
                male: 800,
                female: 850,
                sosialTTK: '40',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Astara",
                male: 700,
                female: 750,
                sosialTTK: '45',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Masallı",
                male: 700,
                female: 600,
                sosialTTK: '46',
                standartTTK: "58",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Masallı",
                male: 700,
                female: 600,
                sosialTTK: '46',
                standartTTK: "58",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    4: {
        id: 4,
        bcgColor: "#D2DF8A",
        title: "Qazax-Tovuz",
        male: 2200,
        female: 2200,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Qazax",
                male: 800,
                female: 850,
                sosialTTK: '42',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Tovuz",
                male: 700,
                female: 750,
                sosialTTK: '43',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Şəmkir",
                male: 700,
                female: 600,
                sosialTTK: '44',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    6: {
        id: 6,
        bcgColor: "#EFDB85",
        title: "Şərqi Zəngəzur",
        male: 2200,
        female: 2200,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Zəngilan",
                male: 800,
                female: 850,
                sosialTTK: '41',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Cəbrayıl",
                male: 700,
                female: 750,
                sosialTTK: '42',
                standartTTK: "58",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Qubadlı",
                male: 700,
                female: 600,
                sosialTTK: '43',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    8: {
        id: 8,
        bcgColor: "#F19CC2",
        title: "Qarabağ",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Şuşa",
                male: 500,
                female: 550,
                sosialTTK: '40',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Laçın",
                male: 400,
                female: 450,
                sosialTTK: '42',
                standartTTK: "54",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Kəlbəcər",
                male: 450,
                female: 400,
                sosialTTK: '43',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    10: {
        id: 10,
        bcgColor: "#F8CCDD",
        title: "Gəncə-Daşkən",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Gəncə",
                male: 1000,
                female: 1050,
                sosialTTK: '41',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Daşkəsən",
                male: 500,
                female: 550,
                sosialTTK: '43',
                standartTTK: "54",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Kəlbəcər",
                male: 450,
                female: 400,
                sosialTTK: '42',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    12: {
        id: 12,
        bcgColor: "#F19CC2",
        title: "Şəki-Zaqatala",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Şəki",
                male: 800,
                female: 850,
                sosialTTK: '39',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Zaqatala",
                male: 700,
                female: 750,
                sosialTTK: '41',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Qax",
                male: 700,
                female: 600,
                sosialTTK: '43',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    14: {
        id: 14,
        bcgColor: "#B7D172",
        title: "Mərkəzi Aran",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Yevlax",
                male: 800,
                female: 850,
                sosialTTK: '40',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Bərdə",
                male: 700,
                female: 750,
                sosialTTK: '42',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Ağdam",
                male: 700,
                female: 600,
                sosialTTK: '43',
                standartTTK: "58",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    16: {
        id: 16,
        bcgColor: "#F2BF5F",
        title: "Mil-Muğan",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Lerik",
                male: 800,
                female: 850,
                sosialTTK: '40',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Astara",
                male: 700,
                female: 750,
                sosialTTK: '42',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Cəlilabad",
                male: 700,
                female: 600,
                sosialTTK: '43',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    18: {
        id: 18,
        bcgColor: "#9BA8D5",
        title: "Şirvan-Salyan",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Şirvan",
                male: 800,
                female: 850,
                sosialTTK: '40',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Salyan",
                male: 700,
                female: 750,
                sosialTTK: '42',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Hacıqabul",
                male: 700,
                female: 600,
                sosialTTK: '43',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    22: {
        id: 22,
        bcgColor: "#0574BA",
        title: "Baku",
        male: 2200,
        female: 2200,
        percentMale: 44,
        percentFemale: 44,
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        sosialTTK: '44',
        standartTTK: "56",
        cities: [
            {
                title: "Bakı",
                male: 2200,
                female: 2200,
                sosialTTK: '44',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Sumqayıt",
                male: 1000,
                female: 1100,
                sosialTTK: '45',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Gəncə",
                male: 1200,
                female: 1300,
                sosialTTK: '46',
                standartTTK: "58",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    20: {
        id: 20,
        bcgColor: "#F19CC2",
        title: "Abşeron-Xızı",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Abşeron",
                male: 800,
                female: 850,
                sosialTTK: '41',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Xızı",
                male: 700,
                female: 750,
                sosialTTK: '42',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Quba",
                male: 700,
                female: 600,
                sosialTTK: '43',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    26: {
        id: 26,
        bcgColor: "#DDE38A",
        title: "Dağlıq-Şırvan",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Şamaxı",
                male: 800,
                female: 850,
                sosialTTK: '40',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Quba",
                male: 700,
                female: 750,
                sosialTTK: '41',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "İsmayıllı",
                male: 700,
                female: 600,
                sosialTTK: '42',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    28: {
        id: 28,
        bcgColor: "#F2D974",
        title: "Quba-Xaçmaz",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Quba",
                male: 800,
                female: 850,
                sosialTTK: '41',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Xaçmaz",
                male: 700,
                female: 750,
                sosialTTK: '42',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Qusar",
                male: 700,
                female: 600,
                sosialTTK: '43',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    },
    30: {
        id: 30,
        bcgColor: "#DBE390",
        title: "Naxçıvan",
        male: 0,
        female: 0,
        percentMale: 44,
        percentFemale: 44,
        sosialTTK: '44',
        standartTTK: "56",
        about: "Lorem ipsum dolor sit amet consectetur. Eget quis eget nulla etiam magna integer egestas. In aliquet et leo diam.",
        cities: [
            {
                title: "Naxçıvan",
                male: 800,
                female: 850,
                sosialTTK: '40',
                standartTTK: "56",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Şərur",
                male: 700,
                female: 750,
                sosialTTK: '41',
                standartTTK: "55",
                percentMale: 44,
                percentFemale: 44,
            },
            {
                title: "Ordubad",
                male: 700,
                female: 600,
                sosialTTK: '42',
                standartTTK: "57",
                percentMale: 44,
                percentFemale: 44,
            }
        ]
    }
};



document.addEventListener('DOMContentLoaded', () => {
    const objectElement = document.getElementById('mySvg');
    const infoBox = document.getElementById('info-box');
    const detailsOverlay = document.querySelector('.details-overlay');
    const detailsContent = document.querySelector('.details-content');
    let currentHighlightedElement = null;

    objectElement.addEventListener('load', () => {
        const svgDoc = objectElement.contentDocument;
        if (svgDoc) {
            const clickableAreas = svgDoc.querySelectorAll('.clickable-area');

            clickableAreas.forEach(area => {
                area.addEventListener('mouseover', (event) => {
                    
                    event.preventDefault();
                    let id = area.getAttribute('data-id');
                    id = parseInt(id, 10); 

                    if (id % 2 !== 0) {
                        id++; 
                    }

                    const elements = svgDoc.querySelectorAll(`.clickable-area[data-id='${id}']`);

                    if (elements && id) {
                        if (currentHighlightedElement && currentHighlightedElement !== elements) {
                            resetElement(currentHighlightedElement);
                        }

                        highlightElement(elements, id);

                        currentHighlightedElement = elements;

                        showInfoBox(elements, id);
                    }
                });

                area.addEventListener('mouseout', (event) => {
                    if (!infoBox.matches(':hover')) {
                        hideInfoBox();
                        if (currentHighlightedElement) {
                            resetElement(currentHighlightedElement);
                            currentHighlightedElement = null;
                        }
                    }
                });
            });

            infoBox.addEventListener('mouseover', () => {
                infoBox.style.display = 'block';
            });

            infoBox.addEventListener('mouseout', () => {
                if (!detailsOverlay.matches(':hover') && !infoBox.matches(':hover')) {
                    hideInfoBox();
                    if (currentHighlightedElement) {
                        resetElement(currentHighlightedElement);
                        currentHighlightedElement = null;
                    }
                }
            });
        }
    });

    function highlightElement(elements, id) {
        const shadowColor = '#0005185';
        elements.forEach(item => {
            item.style.fill = colors[id]?.bcgColor;
            item.style.filter = `drop-shadow(0 0 10px ${shadowColor})`;
            item.style.transform = 'translate(5px, -3px)';
        });
    }

    function resetElement(elements) {
        elements.forEach(item => {
            item.style.fill = '#E9F5FF';
            item.style.filter = 'none';
            item.style.transform = 'none';
        });
        hideInfoBox();
    }

    function showInfoBox(elements, id) {
       infoBox.style.display = 'block';
    const rect = elements[0].getBoundingClientRect();
    const viewportWidth = window.innerWidth;
    const viewportHeight = window.innerHeight;

    let top = rect.top  - infoBox.offsetHeight / 2; // Yuxarıdan orta mövqe
    let left = rect.left + window.scrollX + rect.width / 2 - infoBox.offsetWidth / 2; // Sol tərəfdən orta mövqe

    // Ekranın kənarlarına uyğun düzəlişlər
    if (left + infoBox.offsetWidth > viewportWidth) {
        left = viewportWidth - infoBox.offsetWidth - 20;
    }
    if (left < 0) {
        left = 20;
    }
    if (top + infoBox.offsetHeight > viewportHeight) {
        top = viewportHeight - infoBox.offsetHeight - 20;
    }
    if (top < 0) {
        top = 20;
    }

    infoBox.style.top = `${top}px`;
    infoBox.style.left = `${left}px`;
    
    
        
        infoBox.innerHTML = `
            <h5>${colors[id]?.title}</h5>
            <div class="info-text">
                Kişi:
                <div>
                    <img src="./frq-templates/assets/img/xerite/menicon.svg" alt="">
                    ${colors[id]?.male}
                </div>
            </div>
            <div class="info-text">
                Qadın:
                <div>
                    <img src="./frq-templates/assets/img/xerite/womenicon.svg" alt="">
                    ${colors[id]?.female}
                </div>
            </div>
            <div class="info-text">
                Sosial TTK:
                <div>
                    ${colors[id]?.female}
                    <img src="./frq-templates/assets/img/xerite/ttkwomenicon.svg" alt="">
                </div>
            </div>
            <div class="info-text">
                Standart TTK:
                <div>
                    ${colors[id]?.male}
                    <img src="./frq-templates/assets/img/xerite/ttkmenicon.svg" alt="">
                </div>
            </div>
            <button class="modal-more-btn" onclick="openDetailModal(${colors[id].id})">Ətraflı</button>
        `;
    }

    function hideInfoBox() {
        infoBox.style.display = 'none';
    }

    window.openDetailModal = function (ID) {
        hideInfoBox();

        detailsContent.innerHTML = `
        <div class="details-content-top">
      <div class="details-content-article">
          <h2>${colors[ID].title} iqtisadi rayonu</h2>
          <p>${colors[ID].about}</p>
      </div>
      <div class="map-details-content-statistic-main">
          <div class="map-details-content-statistic-each">
          <div >
          <h3>${colors[ID].male}</h3>
          <img src="./frq-templates/assets/img/xerite/menicon.svg" alt="">
          </div>   
          <div class="info-text">
          <p>Kişi:</p>
              <span>${colors[ID].percentMale}%</span></div>
          </div>
          <div class="map-details-content-statistic-each">
             <div>
             <h3>${colors[ID].sosialTTK}</h3>
             <img src="./frq-templates/assets/img/xerite/ttkwomenicon.svg" alt="">
            </div> 
            <div class="info-text">
            <p>Sosial TTK:</p>
              <span class="female-color">${colors[ID].percentFemale}%</span>
            </div>
          </div>
          <div class="map-details-content-statistic-each">
           <div>
           <h3>${colors[ID].female}</h3>
              <img src="./frq-templates/assets/img/xerite/womenicon.svg" alt="">
              
           </div>   
          <div class="info-text">
          <p>Qadın:</p>
              <span>${colors[ID].percentFemale}%</span>
          </div>
          </div>
          <div class="map-details-content-statistic-each">
          <div>
          <h3>${colors[ID].standartTTK}</h3>
              <img src="./frq-templates/assets/img/xerite/ttkmenicon.svg" alt="">
             
          </div>    
         <div class="info-text">
         <p>Standart TTK:</p>
         <span class="male-color">${colors[ID].percentMale}%</span>
         </div>
          </div>
      </div>

  </div>
  <div class="map-details-statistic-main-bycity">
 ${colors[ID].cities.map(item => {
            return `
      <div class="map-details-statistic-each-bycity">
          <span>${item.title.toUpperCase()}</span>
          <div>
          <div>
         <div>
         <h3>${item.male}</h3>
         <img src="./frq-templates/assets/img/xerite/menicon.svg" alt="">
         </div>
             <div class="info-text">
             <p>Kişi:</p>
             <span>${item.percentMale}%</span>
           
             </div>
          </div>    
        <div>
       <div>
       <h3>${item.female}</h3>
       <img src="./frq-templates/assets/img/xerite/womenicon.svg" alt="">
       </div>
       
         <div class="info-text">
         <p>Qadın:</p>
         <span>${item.percentFemale}%</span>
         </div>
         </div>
        <div>
        <div>
        <h3>${item.sosialTTK}</h3>
        <img src="./frq-templates/assets/img/xerite/ttkwomenicon.svg" alt="">
        </div>
 
       <div class="info-text">
       <p>Sosial TTK:</p>
       <span>${item.percentMale}%</span>
       </div>
             
        </div>  
       <div>
       <div>
       <h3>${item.standartTTK}</h3>
       <img src="./frq-templates/assets/img/xerite/ttkmenicon.svg" alt="">
       </div>
              <div class="info-text">
              <p>Standart TTK:</p>

              <span>${item.percentMale}%</span>
             
              </div>
       </div>
          </div>
  </div>`
        }).join('')}      </div>

  `
        detailsOverlay.style.display = 'flex';
    }

    detailsOverlay.addEventListener('click', (event) => {
        if (event.target === detailsOverlay) {
            detailsOverlay.style.display = 'none';
        }
    });

    document.querySelector(".close-details-map").addEventListener("click", () => {
        detailsOverlay.style.display = 'none';
    });
});
